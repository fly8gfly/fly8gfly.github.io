---
import Disc from './Disc.jsx';
const discNames = ['Home', 'Products', 'youtube', 'flying-tips'];
---

<div class="carousel-wrapper">
  <div class="carousel" id="carousel">
    {discNames.map((name, index) => (
      <Disc name={name} index={index} />
    ))}
  </div>
</div>

<style>
  .carousel-wrapper {
    perspective: 1000px;
    width: 100%;
    height: 400px;
    overflow: hidden;
  }

  .carousel {
    position: relative;
    transform-style: preserve-3d;
    width: 100%;
    height: 100%;
    transition: transform 0.5s ease-out;
  }
</style>

<script type="module">
  window.addEventListener('DOMContentLoaded', () => {
    let angle = 0;
    const carousel = document.getElementById('carousel');

    const rotateCarousel = (delta) => {
      angle += delta;
      carousel.style.transform = `rotateY(${angle}deg)`;
    };

    let startX = null;
    let dragging = false;

    const start = (e) => {
      dragging = true;
      startX = e.touches ? e.touches[0].clientX : e.clientX;
    };

    const move = (e) => {
      if (!dragging) return;
      const x = e.touches ? e.touches[0].clientX : e.clientX;
      const delta = x - startX;
      rotateCarousel(delta * -0.3);
      startX = x;
    };

    const end = () => (dragging = false);

    carousel.addEventListener('mousedown', start);
    carousel.addEventListener('mousemove', move);
    carousel.addEventListener('mouseup', end);
    carousel.addEventListener('touchstart', start);
    carousel.addEventListener('touchmove', move);
    carousel.addEventListener('touchend', end);
  });
</script>
