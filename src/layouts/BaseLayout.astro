---
const { title = "Fly8G" } = Astro.props;
const navLinks = [
  { href: "/", label: "Home" },
  { href: "/products", label: "Products" },
  { href: "/youtube", label: "YouTube" },
  { href: "/flying-tips", label: "Flying Tips" },
];
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Fly8G - Your premier destination for aviation products, flying tips, and inspiring content." />
  <title>{title}</title>

  <script>
    (function() {
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const theme = savedTheme || (prefersDark ? 'dark' : 'light');
      document.documentElement.classList.add(theme);
    })();
  </script>

  <style>
    *, *::before, *::after { box-sizing:border-box; margin:0; padding:0; }

    :root {
      --bg: linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);
      --surface:#fff;
      --text:#111827;
      --muted:#1f2937;
      --accent:#2563eb;
      --header-bg:rgba(255,255,255,0.95);
      --footer-bg:rgba(241,245,249,0.95);
      --nav-bg:rgba(255,255,255,0.98);
      --shadow:0 4px 20px rgba(0,0,0,0.1);
      --card-bg: rgba(255,255,255,0.9);
      --backdrop: rgba(0,0,0,0.5);
    }

    html.dark {
      --bg: linear-gradient(135deg,#0f172a 0%,#1e293b 100%);
      --surface:#1f2937;
      --text:#f1f5f9;
      --muted:#9ca3af;
      --accent:#3b82f6;
      --header-bg:rgba(17,24,39,0.95);
      --footer-bg:rgba(31,41,55,0.95);
      --nav-bg:rgba(17,24,39,0.98);
      --shadow:0 8px 20px rgba(0,0,0,0.6);
      --card-bg: rgba(15,23,42,0.95);
      --backdrop: rgba(0,0,0,0.85);
    }

    body {
      background: var(--bg);
      color: var(--text);
      min-height:100vh;
      display:flex;
      flex-direction:column;
      font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
      transition: background 0.3s ease, color 0.3s ease;
      visibility:hidden;
      opacity:0;
    }

    body.theme-ready { visibility: visible; opacity:1; }

    a { color: var(--accent); text-decoration:none; transition: color 0.2s ease; }
    a:hover,a:focus-visible { text-decoration: underline; outline:2px solid var(--accent); outline-offset:2px; }

    main { flex:1; padding:2rem; max-width:1280px; margin:0 auto; }
    main p, main ul, main ol { line-height:1.7; margin-bottom:1.25rem; color: var(--text); }
    main h1,main h2,main h3,main h4,main h5,main h6 { color:var(--text); margin:2rem 0 1rem; font-weight:600; }

    .card {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: var(--shadow);
      transition: background 0.3s ease, box-shadow 0.3s ease;
    }

    header { background:var(--header-bg); backdrop-filter:blur(8px); display:flex; align-items:center; justify-content:space-between; padding:0 1.5rem; position:sticky; top:0; height:64px; z-index:100; box-shadow:var(--shadow); }

    .hamburger { display:flex; flex-direction:column; justify-content:space-around; width:30px; height:24px; cursor:pointer; z-index:110; background:transparent; border:none; padding:0; }
    .hamburger div { width:100%; height:3px; background: var(--text); border-radius:3px; transition: all 0.3s ease; }
    .hamburger.open div:nth-child(1){ transform: rotate(45deg) translate(6px,6px);}
    .hamburger.open div:nth-child(2){ opacity:0; }
    .hamburger.open div:nth-child(3){ transform: rotate(-45deg) translate(7px,-7px);}
    .hamburger:focus-visible{ outline:2px solid var(--accent); outline-offset:2px; border-radius:4px; }

    .logo { flex:1; text-align:center; }
    .logo img { height:48px; width:auto; user-select:none; }

    nav { position:fixed; top:64px; left:0; width:240px; height:calc(100% - 64px); background:var(--nav-bg); padding:1.5rem; transform:translateX(-100%); transition:transform 0.3s ease; display:flex; flex-direction:column; gap:1.25rem; z-index:105; box-shadow:var(--shadow);}
    nav::before { content:''; position:fixed; top:64px; left:240px; right:0; bottom:0; background: var(--backdrop); opacity:0; pointer-events:none; transition:opacity 0.3s ease; z-index:-1;}
    nav.open { transform:translateX(0);}
    nav.open::before { opacity:1; pointer-events:auto;}
    nav a { font-size:1.1rem; font-weight:500; padding:0.5rem; border-radius:4px; transition:background 0.2s ease; color:var(--text);}
    nav a:hover,nav a:focus-visible { background: var(--surface); text-decoration:none; outline:none; }

    footer { background:var(--footer-bg); backdrop-filter:blur(8px); text-align:center; padding:1.5rem; color:var(--muted); font-size:0.875rem;}

    #dark-mode-toggle {
      background: transparent;
      border: 2px solid var(--accent);
      color: var(--accent);
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    #dark-mode-toggle:hover, #dark-mode-toggle:focus-visible {
      background: var(--accent);
      color: var(--surface);
      outline: none;
    }

    @media (min-width: 768px) {
      nav{position:static; transform:none; height:auto; background:transparent; padding:0; flex-direction:row; gap:1.5rem; width:auto; box-shadow:none;} 
      nav::before{display:none;} 
      .hamburger{display:none;} 
      main{padding:3rem 2rem;} 
      #dark-mode-toggle{margin-left:1rem;} 
    }

    @media(prefers-reduced-motion: reduce){*,*::before,*::after{transition:none !important;}}
    @media print{header, footer, #dark-mode-toggle{display:none;} body{background:white !important; color:black !important;}}
  </style>
</head>
<body>
  <header>
    <button class="hamburger" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="nav-menu" id="hamburger-button" type="button">
      <div></div><div></div><div></div>
    </button>

    <div class="logo">
      <a href="/" aria-label="Fly8G Home">
        <img src="/logo.jpg" alt="Fly8G Logo" width="48" height="48" loading="eager" fetchpriority="high" />
      </a>
    </div>

    <nav id="nav-menu" aria-label="Primary Navigation">
      {navLinks.map(({ href, label }) => (
        <a href={href} rel="prefetch" aria-current={Astro.url.pathname === href ? 'page' : undefined}>{label}</a>
      ))}
    </nav>

    <button id="dark-mode-toggle" aria-label="Toggle between light and dark mode">🌙</button>
  </header>

  <main>
    <slot />
  </main>

  <footer>
    &copy; {new Date().getFullYear()} Fly8G &mdash; <a href="mailto:contact@fly8g.com">contact@fly8g.com</a>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const darkToggle = document.getElementById('dark-mode-toggle');
      const hamburger = document.getElementById('hamburger-button');
      const navMenu = document.getElementById('nav-menu');

      const updateToggleIcon = () => {
        darkToggle.textContent = document.documentElement.classList.contains('dark') ? '🌙' : '☀️';
      };

      hamburger.addEventListener('click', () => {
        const expanded = hamburger.getAttribute('aria-expanded') === 'true';
        hamburger.setAttribute('aria-expanded', String(!expanded));
        hamburger.classList.toggle('open');
        navMenu.classList.toggle('open');
      });

      darkToggle.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        document.documentElement.classList.toggle('light');
        localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        updateToggleIcon();
      });

      document.addEventListener('click', (e) => {
        if (!navMenu.contains(e.target) && !hamburger.contains(e.target) && navMenu.classList.contains('open')) {
          hamburger.setAttribute('aria-expanded','false');
          hamburger.classList.remove('open');
          navMenu.classList.remove('open');
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && navMenu.classList.contains('open')) {
          hamburger.setAttribute('aria-expanded','false');
          hamburger.classList.remove('open');
          navMenu.classList.remove('open');
          hamburger.focus();
        }
      });

      document.body.classList.add('theme-ready');
      updateToggleIcon();
    });
  </script>
</body>
</html>
